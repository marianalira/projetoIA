#public String buscarPorCNPJ()
buscarPorCNPJ = SELECT ORI.ORI_NRCNPJ, ORI.ORI_DSORGAO, 0 AS VALORMES, 0 AS VALORATEMES FROM ODS.TB_ORI_ORGAO_IGESP ORI WHERE ORI.ORI_NRCNPJ = :cnpj 
#public String buscarPorCNPJ_Nome()
buscarPorCNPJ_Nome = SELECT ORI.ORI_NRCNPJ || ' - ' || ORI.ORI_DSORGAO as Orgao FROM ODS.TB_ORI_ORGAO_IGESP ORI WHERE upper(ORI.ORI_DSORGAO) like '%' || upper(:orgao) || '%' 
#public String buscarDespesas()
buscarDespesas = SELECT CNPJ, DECODE(ORGAO, 'ZZTOTAL', 'TOTAL', ORGAO) AS ORGAO, VL_MES, VL_ATEMES FROM (WITH ENTIDADE AS (SELECT ORI.ORI_NRCNPJ AS CNPJ, ORI.ORI_DSORGAO AS ORGAO, NVL((SELECT SUM(PIG.PIG_VLPAGO) AS VL_ATEMES FROM ODS.TB_PIG_PAGAMENTO_IGESP   PIG, ODS.TB_UGI_UNIDADE_GOV_IGESP UGI WHERE PIG.PIG_NRANO = :ano AND PIG.PIG_NRMES = :mes AND PIG.PIG_CDUG = UGI.UGI_CDUNIDADE AND (UGI.ORI_CDORGAO IN ( SELECT ORI2.ORI_CDORGAO FROM ODS.TB_ORI_ORGAO_IGESP ORI2 START WITH ORI2.ORI_CDORGAOSUPERVISOR = ORI.ORI_CDORGAO CONNECT BY PRIOR ORI2.ORI_CDORGAO = ORI2.ORI_CDORGAOSUPERVISOR UNION SELECT ORI3.ORI_CDORGAO FROM ODS.TB_ORI_ORGAO_IGESP ORI3 WHERE ORI3.ORI_CDORGAO = ORI.ORI_CDORGAO ) ) AND PIG.PIG_CDSITUACAOOB = 4),0) AS VL_MES, NVL((SELECT SUM(PIG.PIG_VLPAGO) AS VL_ATEMES FROM ODS.TB_PIG_PAGAMENTO_IGESP   PIG, ODS.TB_UGI_UNIDADE_GOV_IGESP UGI WHERE PIG.PIG_NRANO = :ano AND PIG.PIG_NRMES BETWEEN 1 AND :mes AND PIG.PIG_CDUG = UGI.UGI_CDUNIDADE AND (UGI.ORI_CDORGAO IN ( SELECT ORI2.ORI_CDORGAO FROM ODS.TB_ORI_ORGAO_IGESP ORI2 START WITH ORI2.ORI_CDORGAOSUPERVISOR = ORI.ORI_CDORGAO CONNECT BY PRIOR ORI2.ORI_CDORGAO = ORI2.ORI_CDORGAOSUPERVISOR UNION SELECT ORI3.ORI_CDORGAO FROM ODS.TB_ORI_ORGAO_IGESP ORI3 WHERE ORI3.ORI_CDORGAO = ORI.ORI_CDORGAO ) ) AND PIG.PIG_CDSITUACAOOB = 4),0) AS VL_ATEMES FROM ODS.TB_ORI_ORGAO_IGESP ORI WHERE ORI.PDE_CDPODER = 3 AND ORI.ORI_CDORGAOSUPERVISOR IS NULL AND ORI.ORI_NRCNPJ NOT IN ('13168687000110', '03258406712582')) SELECT * FROM ENTIDADE WHERE VL_ATEMES > 0 UNION SELECT 'XX999999999999' AS CNPJ, 'ZZTOTAL' AS ORGAO, SUM(VL_MES) AS VL_MES, SUM(VL_ATEMES) AS VL_ATEMES FROM ENTIDADE ORDER BY 2)         
#public String buscarDespesasAvancada(String cnpj, String orgao)
buscarDespesasAvancada = SELECT CNPJ, DECODE(ORGAO, 'ZZTOTAL', 'TOTAL', ORGAO) AS ORGAO, VL_MES, VL_ATEMES FROM (WITH ENTIDADE AS (SELECT ORI.ORI_NRCNPJ AS CNPJ, ORI.ORI_DSORGAO AS ORGAO, NVL((SELECT SUM(PIG.PIG_VLPAGO) AS VL_ATEMES FROM ODS.TB_PIG_PAGAMENTO_IGESP   PIG, ODS.TB_UGI_UNIDADE_GOV_IGESP UGI WHERE PIG.PIG_NRANO = :ano AND PIG.PIG_NRMES = :mes AND PIG.PIG_CDUG = UGI.UGI_CDUNIDADE AND (UGI.ORI_CDORGAO IN ( SELECT ORI2.ORI_CDORGAO FROM ODS.TB_ORI_ORGAO_IGESP ORI2 START WITH ORI2.ORI_CDORGAOSUPERVISOR = ORI.ORI_CDORGAO CONNECT BY PRIOR ORI2.ORI_CDORGAO = ORI2.ORI_CDORGAOSUPERVISOR UNION SELECT ORI3.ORI_CDORGAO FROM ODS.TB_ORI_ORGAO_IGESP ORI3 WHERE ORI3.ORI_CDORGAO = ORI.ORI_CDORGAO ) ) AND PIG.PIG_CDSITUACAOOB = 4),0) AS VL_MES, NVL((SELECT SUM(PIG.PIG_VLPAGO) AS VL_ATEMES FROM ODS.TB_PIG_PAGAMENTO_IGESP   PIG, ODS.TB_UGI_UNIDADE_GOV_IGESP UGI WHERE PIG.PIG_NRANO = :ano AND PIG.PIG_NRMES BETWEEN 1 AND :mes AND PIG.PIG_CDUG = UGI.UGI_CDUNIDADE AND (UGI.ORI_CDORGAO IN ( SELECT ORI2.ORI_CDORGAO FROM ODS.TB_ORI_ORGAO_IGESP ORI2 START WITH ORI2.ORI_CDORGAOSUPERVISOR = ORI.ORI_CDORGAO CONNECT BY PRIOR ORI2.ORI_CDORGAO = ORI2.ORI_CDORGAOSUPERVISOR UNION SELECT ORI3.ORI_CDORGAO FROM ODS.TB_ORI_ORGAO_IGESP ORI3 WHERE ORI3.ORI_CDORGAO = ORI.ORI_CDORGAO ) ) AND PIG.PIG_CDSITUACAOOB = 4),0) AS VL_ATEMES FROM ODS.TB_ORI_ORGAO_IGESP ORI WHERE ORI.PDE_CDPODER = 3 AND ORI.ORI_CDORGAOSUPERVISOR IS NULL AND ORI.ORI_NRCNPJ NOT IN ('13168687000110', '03258406712582')) SELECT * FROM ENTIDADE WHERE VL_ATEMES > 0 {0} {1} UNION SELECT 'XX999999999999' AS CNPJ, 'ZZTOTAL' AS ORGAO, SUM(VL_MES) AS VL_MES, SUM(VL_ATEMES) AS VL_ATEMES FROM ENTIDADE ORDER BY 2)    
#public String buscarPorId()
buscarPorId = SELECT CNPJ, DECODE(ORGAO, 'ZZTOTAL', 'TOTAL', ORGAO) AS ORGAO, VL_MES, VL_ATEMES FROM (WITH ENTIDADE AS (SELECT ORI.ORI_NRCNPJ AS CNPJ, ORI.ORI_DSORGAO AS ORGAO, NVL((SELECT SUM(PIG.PIG_VLPAGO) AS VL_ATEMES FROM ODS.TB_PIG_PAGAMENTO_IGESP   PIG, ODS.TB_UGI_UNIDADE_GOV_IGESP UGI WHERE PIG.PIG_NRANO = :ano AND PIG.PIG_NRMES = :mes AND PIG.PIG_CDUG = UGI.UGI_CDUNIDADE AND (UGI.ORI_CDORGAO = ORI.ORI_CDORGAO OR (UGI.ORI_CDORGAO IN (SELECT ORI2.ORI_CDORGAO FROM ODS.TB_ORI_ORGAO_IGESP ORI2 START WITH ORI2.ORI_CDORGAOSUPERVISOR = ORI.ORI_CDORGAO CONNECT BY PRIOR ORI2.ORI_CDORGAO = ORI2.ORI_CDORGAOSUPERVISOR))) AND PIG.PIG_CDSITUACAOOB = 4), 0) AS VL_MES, NVL((SELECT SUM(PIG.PIG_VLPAGO) AS VL_ATEMES FROM ODS.TB_PIG_PAGAMENTO_IGESP   PIG, ODS.TB_UGI_UNIDADE_GOV_IGESP UGI WHERE PIG.PIG_NRANO = :ano AND PIG.PIG_NRMES BETWEEN 1 AND :mes AND PIG.PIG_CDUG = UGI.UGI_CDUNIDADE AND (UGI.ORI_CDORGAO = ORI.ORI_CDORGAO OR (UGI.ORI_CDORGAO IN (SELECT ORI2.ORI_CDORGAO FROM ODS.TB_ORI_ORGAO_IGESP ORI2 START WITH ORI2.ORI_CDORGAOSUPERVISOR = ORI.ORI_CDORGAO CONNECT BY PRIOR ORI2.ORI_CDORGAO = ORI2.ORI_CDORGAOSUPERVISOR))) AND PIG.PIG_CDSITUACAOOB = 4), 0) AS VL_ATEMES FROM ODS.TB_ORI_ORGAO_IGESP ORI WHERE ORI.PDE_CDPODER = 3 AND ORI.ORI_CDORGAOSUPERVISOR IS NULL AND ORI.ORI_NRCNPJ NOT IN ('13168687000110', '03258406712582')) SELECT * FROM ENTIDADE WHERE VL_ATEMES > 0 AND CODIGO = :id UNION SELECT 'XX999999999999' AS CNPJ, 'ZZTOTAL' AS ORGAO, SUM(VL_MES) AS VL_MES, SUM(VL_ATEMES) AS VL_ATEMES FROM ENTIDADE ORDER BY 2)  
#public String buscarRepasseAosPoderes()
buscarRepasseAosPoderes = Select per_nrano, ori_dsOrgao, janeiro, fevereiro, marco, abril, maio, junho, julho, agosto, setembro, outubro, novembro, dezembro, (janeiro + fevereiro + marco + abril + maio + junho + julho + agosto + setembro + outubro + novembro + dezembro) total FROM (Select per_nrano, ori_dsOrgao, sum(janeiro) janeiro, sum(fevereiro) fevereiro, sum(marco) marco, sum(abril) abril, sum(maio) maio, sum(junho) junho, sum(julho) julho, sum(agosto) agosto, sum(setembro) setembro, sum(outubro) outubro, sum(novembro) novembro, sum(dezembro) dezembro FROM (Select extract(year from rep.rep_dtpagamento) as per_nrano, ori.ori_cdorgao, ori.ori_dsorgao, Decode(extract (month from rep.rep_dtpagamento), 1, rep.rep_vlrepasse, 0) janeiro, Decode(extract (month from rep.rep_dtpagamento), 2, rep.rep_vlrepasse, 0) fevereiro, Decode(extract (month from rep.rep_dtpagamento), 3, rep.rep_vlrepasse, 0) marco, Decode(extract (month from rep.rep_dtpagamento), 4, rep.rep_vlrepasse, 0) abril, Decode(extract (month from rep.rep_dtpagamento), 5, rep.rep_vlrepasse, 0) maio, Decode(extract (month from rep.rep_dtpagamento), 6, rep.rep_vlrepasse, 0) junho, Decode(extract (month from rep.rep_dtpagamento), 7, rep.rep_vlrepasse, 0) julho, Decode(extract (month from rep.rep_dtpagamento), 8, rep.rep_vlrepasse, 0) agosto, Decode(extract (month from rep.rep_dtpagamento), 9, rep.rep_vlrepasse, 0) setembro, Decode(extract (month from rep.rep_dtpagamento), 10, rep.rep_vlrepasse, 0) outubro, Decode(extract (month from rep.rep_dtpagamento), 11, rep.rep_vlrepasse, 0) novembro, Decode(extract (month from rep.rep_dtpagamento), 12, rep.rep_vlrepasse, 0) dezembro From ods.tb_rep_repasse_poderes rep, ods.tb_ori_orgao_igesp ori Where rep.rep_cdorgao = ori.ori_cdorgao and extract(year from rep.rep_dtpagamento) = :ano) Group by ori_dsOrgao, per_nrano)  
#public String buscarReceitaMensal()
buscarReceitaMensal = Select 0 as grid,'00' as Cod,'A - TOTAL RECEITA BRUTA (1+2)' as nre_nmnaturezareceita, NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0) as no_mes, ROUND((((NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0) ) / DECODE(NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0), 0,1, NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0) )) * 100),2) as perc, NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0) as ate_mes, ROUND((((NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0) ) / DECODE(NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0), 0,1, NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0))) * 100),2) as perc1 From DUAL UNION Select 1 as grid,'01' as Cod,'      1 - RECEITAS CORRENTES' as nre_nmnaturezareceita, NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '1' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0) as no_mes, ROUND((((NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '1' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0) ) / DECODE(NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0), 0,1, NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0) )) * 100),2) as perc, NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '1' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0) as ate_mes, ROUND((((NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '1' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0) ) / DECODE(NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0), 0,1, NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0))) * 100),2) as perc1 From DUAL UNION Select 2 as grid,substr(nre.nre_cdnaturezareceita,1,2) as Cod,'           '||nre.nre_nmnaturezareceita as nre_nmnaturezareceita, NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0) as no_mes, ROUND((( ( NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0) ) / DECODE(NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0), 0,1, NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0) ) ) * 100),2) as Perc, NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0) as ate_mes, ROUND((( ( NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0) ) / DECODE(NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0), 0,1, NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0)) ) * 100),2) as Perc1 From ods.tb_nre_natureza_receita nre Where substr(nre.nre_cdnaturezareceita,1,1) = '1' and substr(nre.nre_cdnaturezareceita,2,1) <> '0' and substr(nre.nre_cdnaturezareceita,3,6) = '000000' and nre.nre_dtfimvigencia is null UNION Select 3 as grid,'02' as Cod,'      2 - RECEITAS DE CAPITAL' as nre_nmnaturezareceita, NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '2' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0) as no_mes, ROUND((((NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '2' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0)) / DECODE(NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0), 0,1, NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0)))*100),2) as perc, NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '2' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0) as ate_mes, ROUND((((NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '2' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0)) / DECODE(NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0), 0,1, NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0)))*100),2) as perc1 From DUAL UNION Select 4 as grid,substr(nre.nre_cdnaturezareceita,1,2) as Cod,'           '||nre.nre_nmnaturezareceita as nre_nmnaturezareceita, NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0) as no_mes, ROUND((( ( NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0) ) / DECODE(NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0), 0,1, NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0)) ) * 100),2) as Perc , NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0) as ate_mes, ROUND((( ( NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0) ) / DECODE(NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0), 0,1, NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0)) ) * 100),2) as Perc1 From ods.tb_nre_natureza_receita nre Where substr(nre.nre_cdnaturezareceita,1,1) = '2' and substr(nre.nre_cdnaturezareceita,2,1) <> '0' and substr(nre.nre_cdnaturezareceita,3,6) = '000000' and nre.nre_dtfimvigencia is null UNION Select 5,'100',null,null,null,null,null From Dual UNION Select 6 as grid,'00' as Cod,'B - TOTAL DAS OPER. INTRA. (7)' as nre_nmnaturezareceita, NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1)  = '7' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0) as no_mes, ROUND((((NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1)  = '7' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0) ) / DECODE(NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1)  = '7' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0), 0,1, NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1)  = '7' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0) )) * 100),2) as perc, NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1)  = '7' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0) as ate_mes, ROUND((((NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '7' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0) ) / DECODE(NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '7' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0), 0,1, NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '7' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0))) * 100),2) as perc1 From DUAL UNION Select 7 as grid,'07' as Cod,'       7 - RECEITAS CORRENTES - OPER. INTRA.' as nre_nmnaturezareceita, NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '7' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0) as no_mes, ROUND((((NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '7' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0)) / DECODE(NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '7' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0),0,1, NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '7' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0)))*100),2) as perc, NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '7' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0) as ate_mes, ROUND((((NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '7' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0)) / DECODE(NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '7' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0),0,1, NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '7' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0)))*100),2) as perc1 From DUAL UNION Select 8 as grid,substr(nre.nre_cdnaturezareceita,1,2) as Cod,'            '||nre.nre_nmnaturezareceita as nre_nmnaturezareceita, NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0) as no_mes, ROUND((( ( NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0) ) / DECODE(NVL((Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '7' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0),0,1, NVL((Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '7' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0)) ) * 100),2) as Perc , NVL((Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0) as ate_mes, ROUND((( ( NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0) ) / DECODE(NVL((Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '7' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0),0,1, NVL((Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '7' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0)) ) * 100),2) as Perc1 From ods.tb_nre_natureza_receita nre Where substr(nre.nre_cdnaturezareceita,1,1) = '7' and substr(nre.nre_cdnaturezareceita,2,1) <> '0' and substr(nre.nre_cdnaturezareceita,3,6) = '000000' and nre.nre_dtfimvigencia is null UNION Select 9,'100',null,null,null,null,null From Dual UNION Select 10 as grid,'00' as Cod,'C - TOTAL DE DEDUÇÕES (9)' as nre_nmnaturezareceita, NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada))  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1)  = '9' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0) as no_mes, ROUND((((NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada))  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1)  = '9' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0) ) / DECODE(NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada))  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1)  = '9' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0), 0,1, NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada))  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1)  = '9' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0) )) * 100),2) as perc, NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada))  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1)  = '9' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0) as ate_mes, ROUND((((NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada))  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0) ) / DECODE(NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada))  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0), 0,1, NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada))  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0))) * 100),2) as perc1 From DUAL UNION Select 11 as grid,'09' as Cod,'       9 - DEDUÇÕES DE RECEITA CORRENTE' as nre_nmnaturezareceita, NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada))  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0) as no_mes, ROUND((((NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada))  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0)) / DECODE(NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada))  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0),0,1, NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada))  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0)))*100),2) as perc, NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada))  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0) as ate_mes, ROUND((((NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada))  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0)) / DECODE(NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada))  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0),0,1, NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada))  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0)))*100),2) as perc1 From DUAL UNION Select 12 as grid,substr(nre.nre_cdnaturezareceita,1,2) as Cod,'            '||nre.nre_nmnaturezareceita as nre_nmnaturezareceita, NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada))  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0) as no_mes, ROUND((( ( NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada))  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0) ) / DECODE(NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada))  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0),0,1, NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada))  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ),0))) * 100),2) as Perc , NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada))  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0) as ate_mes, ROUND((( ( NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada))  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0) ) / DECODE(NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada))  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0),0,1, NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada))  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0))) * 100),2) as Perc1 From ods.tb_nre_natureza_receita nre Where substr(nre.nre_cdnaturezareceita,1,1) = '9' and substr(nre.nre_cdnaturezareceita,2,1) <> '0' and substr(nre.nre_cdnaturezareceita,3,6) = '000000' and nre.nre_dtfimvigencia is null UNION Select 13,'100',null,null,null,null,null From Dual UNION Select 14 as grid,'00' as Cod,'D - RECEITA LIQUIDA (A-C)' as nre_nmnaturezareceita, NVL( ((Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes = :mes ) - (NVL((Select SUM(ABS(reb.reb_vlreceitaarrecadada))  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes),0 ) )),0) as no_mes, null as perc, NVL( ((Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ) - (NVL((Select SUM(ABS(reb.reb_vlreceitaarrecadada))  From ods.tb_reb_receita_bruta reb where substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes ),0)) ),0) as ate_mes, null as perc1 From DUAL 
#public String buscarReceitaMensalPorOrgao()
buscarReceitaMensalPorOrgao = Select 0 as grid,'00' as Cod,'A - TOTAL RECEITA BRUTA (1+2)' as nre_nmnaturezareceita, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0) as no_mes, ROUND((((NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao ),0) ) / DECODE(NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0), 0,1, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0) )) * 100),2) as perc, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0) as ate_mes, ROUND((((NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0) ) / DECODE(NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0), 0,1, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0))) * 100),2) as perc1 From DUAL UNION Select 1 as grid,'01' as Cod,'      1 - RECEITAS CORRENTES' as nre_nmnaturezareceita, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '1' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0) as no_mes, ROUND((((NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '1' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0) ) / DECODE(NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0), 0,1, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0) )) * 100),2) as perc, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '1' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0) as ate_mes, ROUND((((NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '1' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0) ) / DECODE(NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0), 0,1, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0))) * 100),2) as perc1 From DUAL UNION  Select 2 as grid,substr(nre.nre_cdnaturezareceita,1,2) as Cod,'           '||nre.nre_nmnaturezareceita as nre_nmnaturezareceita, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0) as no_mes, ROUND((( ( NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0) ) / DECODE(NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0), 0,1, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0) ) ) * 100),2) as Perc, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0) as ate_mes, ROUND((( ( NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0) ) / DECODE(NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0), 0,1, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0)) ) * 100),2) as Perc1 From ods.tb_nre_natureza_receita nre Where substr(nre.nre_cdnaturezareceita,1,1) = '1' and substr(nre.nre_cdnaturezareceita,2,1) <> '0' and substr(nre.nre_cdnaturezareceita,3,6) = '000000' and nre.nre_dtfimvigencia is null UNION Select 3 as grid,'02' as Cod,'      2 - RECEITAS DE CAPITAL' as nre_nmnaturezareceita, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '2' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0) as no_mes, ROUND((((NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '2' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0)) / DECODE(NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0), 0,1, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0)))*100),2) as perc, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '2' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0) as ate_mes, ROUND((((NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '2' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0)) / DECODE(NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0), 0,1, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0)))*100),2) as perc1 From DUAL UNION Select 4 as grid,substr(nre.nre_cdnaturezareceita,1,2) as Cod,'           '||nre.nre_nmnaturezareceita as nre_nmnaturezareceita, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0) as no_mes, ROUND((( ( NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0) ) / DECODE(NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0), 0,1, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0)) ) * 100),2) as Perc , NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0) as ate_mes, ROUND((( ( NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0) ) / DECODE(NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0), 0,1, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0)) ) * 100),2) as Perc1 From ods.tb_nre_natureza_receita nre Where substr(nre.nre_cdnaturezareceita,1,1) = '2' and substr(nre.nre_cdnaturezareceita,2,1) <> '0' and substr(nre.nre_cdnaturezareceita,3,6) = '000000' and nre.nre_dtfimvigencia is null UNION Select 5,'100',null,null,null,null,null From Dual UNION Select 6 as grid,'00' as Cod,'B - TOTAL DAS OPER. INTRA. (7)' as nre_nmnaturezareceita, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1)  = '7' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0) as no_mes, ROUND((((NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1)  = '7' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0) ) / DECODE(NVL( (Select SUM(reb.reb_vlreceitaarrecadada)  From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1)  = '7' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0), 0,1, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1)  = '7' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0) )) * 100),2) as perc, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1)  = '7' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0) as ate_mes, ROUND((((NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '7' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0) ) / DECODE(NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '7' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0), 0,1, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '7' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0))) * 100),2) as perc1 From DUAL UNION Select 7 as grid,'07' as Cod,'       7 - RECEITAS CORRENTES - OPER. INTRA.' as nre_nmnaturezareceita, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '7' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0) as no_mes, ROUND((((NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '7' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0)) / DECODE(NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '7' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0),0,1, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '7' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0)))*100),2) as perc, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '7' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0) as ate_mes, ROUND((((NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '7' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0)) / DECODE(NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '7' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0),0,1, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '7' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0)))*100),2) as perc1 From DUAL UNION Select 8 as grid,substr(nre.nre_cdnaturezareceita,1,2) as Cod,'            '||nre.nre_nmnaturezareceita as nre_nmnaturezareceita, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0) as no_mes, ROUND((( ( NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0) ) / DECODE(NVL((Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '7' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0),0,1, NVL((Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '7' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0)) ) * 100),2) as Perc , NVL((Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0) as ate_mes, ROUND((( ( NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0) ) / DECODE(NVL((Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '7' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0),0,1, NVL((Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '7' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0)) ) * 100),2) as Perc1 From ods.tb_nre_natureza_receita nre Where substr(nre.nre_cdnaturezareceita,1,1) = '7' and substr(nre.nre_cdnaturezareceita,2,1) <> '0' and substr(nre.nre_cdnaturezareceita,3,6) = '000000' and nre.nre_dtfimvigencia is null UNION Select 9,'100',null,null,null,null,null From Dual UNION Select 10 as grid,'00' as Cod,'C - TOTAL DE DEDUÇÕES (9)' as nre_nmnaturezareceita, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1)  = '9' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0) as no_mes, ROUND((((NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1)  = '9' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0) ) / DECODE(NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1)  = '9' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0), 0,1, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1)  = '9' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0) )) * 100),2) as perc, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1)  = '9' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0) as ate_mes, ROUND((((NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0) ) / DECODE(NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0), 0,1, NVL( (Select SUM(reb.reb_vlreceitaarrecadada) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0))) * 100),2) as perc1 From DUAL UNION Select 11 as grid,'09' as Cod,'       9 - DEDUÇÕES DE RECEITA CORRENTE' as nre_nmnaturezareceita, NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada)) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0) as no_mes, ROUND((((NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada)) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0)) / DECODE(NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada)) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0),0,1, NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada)) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0)))*100),2) as perc, NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada)) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0) as ate_mes, ROUND((((NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada)) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0)) / DECODE(NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada)) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0),0,1, NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada)) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0)))*100),2) as perc1 From DUAL UNION Select 12 as grid,substr(nre.nre_cdnaturezareceita,1,2) as Cod,'            '||nre.nre_nmnaturezareceita as nre_nmnaturezareceita, NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada)) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0) as no_mes, ROUND((( ( NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada)) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0) ) / DECODE(NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada)) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0),0,1, NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada)) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0))) * 100),2) as Perc , NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada)) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0) as ate_mes, ROUND((( ( NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada)) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,2) = substr(nre.nre_cdnaturezareceita,1,2) and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0) ) / DECODE(NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada)) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0),0,1, NVL( (Select SUM(ABS(reb.reb_vlreceitaarrecadada)) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0))) * 100),2) as Perc1 From ods.tb_nre_natureza_receita nre Where substr(nre.nre_cdnaturezareceita,1,1) = '9' and substr(nre.nre_cdnaturezareceita,2,1) <> '0' and substr(nre.nre_cdnaturezareceita,3,6) = '000000' and nre.nre_dtfimvigencia is null UNION Select 13,'100',null,null,null,null,null From Dual UNION Select 14 as grid,'00' as Cod,'D - RECEITA LIQUIDA (A-C)' as nre_nmnaturezareceita, NVL( ((Select SUM(ABS(reb.reb_vlreceitaarrecadada)) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao) - (NVL((Select SUM(ABS(reb.reb_vlreceitaarrecadada)) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes = :mes and ori.ori_nrcnpj = :orgao),0 ) )),0) as no_mes, null as perc, NVL( ((Select SUM(ABS(reb.reb_vlreceitaarrecadada)) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) IN ('1','2') and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao) - (NVL((Select SUM(ABS(reb.reb_vlreceitaarrecadada)) From ods.tb_reb_receita_bruta reb, ods.tb_ugi_unidade_gov_igesp ugi, ods.tb_ori_orgao_igesp ori where reb.ugi_cdunidade = ugi.ugi_cdunidade and ugi.ori_cdorgao = ori.ori_cdorgao and substr(reb.nre_cdnatureza,1,1) = '9' and reb.reb_nrano = :ano and reb.reb_nrmes between 1 and :mes and ori.ori_nrcnpj = :orgao),0)) ),0) as ate_mes, null as perc1 From DUAL  
#public String buscarReceitaAnual()
buscarReceitaAnual = Select '01' as GRID, nvl(Cod,0) as Cod, nvl(ORIGEM,'      NÃO INFORMADO') as Origem, Sum(DECODE(reb_nrmes, 1, reb_vlreceitaarrecadada, 0)) as "JAN", Sum(DECODE(reb_nrmes, 2, reb_vlreceitaarrecadada, 0)) as "FEV", Sum(DECODE(reb_nrmes, 3, reb_vlreceitaarrecadada, 0)) as "MAR", Sum(DECODE(reb_nrmes, 4, reb_vlreceitaarrecadada, 0)) as "ABR", Sum(DECODE(reb_nrmes, 5, reb_vlreceitaarrecadada, 0)) as "MAI", Sum(DECODE(reb_nrmes, 6, reb_vlreceitaarrecadada, 0)) as "JUN", Sum(DECODE(reb_nrmes, 7, reb_vlreceitaarrecadada, 0)) as "JUL", Sum(DECODE(reb_nrmes, 8, reb_vlreceitaarrecadada, 0)) as "AGO", Sum(DECODE(reb_nrmes, 9, reb_vlreceitaarrecadada, 0)) as "SET", Sum(DECODE(reb_nrmes, 10, reb_vlreceitaarrecadada, 0)) as "OUT", Sum(DECODE(reb_nrmes, 11, reb_vlreceitaarrecadada, 0)) as "NOV", Sum(DECODE(reb_nrmes, 12, reb_vlreceitaarrecadada, 0)) as "DEZ", Sum(reb_vlreceitaarrecadada) as Tot_arrec, Sum(reb_vlreceitaOrcada) as Tot_Orcado, round(Sum(reb_vlreceitaarrecadada) / decode(Sum(reb_vlreceitaOrcada), 0, 1, Sum(reb_vlreceitaOrcada)) * 100, 2) as Perc_Arrec_Orca from (Select '01' as Cod, '1 - RECEITAS CORRENTES' as Origem, rb.reb_nrmes, rb.reb_vlreceitaarrecadada, rb.reb_vlreceitaorcada From ods.tb_reb_receita_bruta rb where rb.reb_nrano = :ano and substr(rb.nre_cdnatureza, 1, 1) = '1') Group by Cod, origem UNION Select '02' as GRID, nvl(Cod,0) as Cod, nvl(ORIGEM,'      NÃO INFORMADO') as Origem, Sum(DECODE(reb_nrmes, 1, reb_vlreceitaarrecadada, 0)) as "JAN", Sum(DECODE(reb_nrmes, 2, reb_vlreceitaarrecadada, 0)) as "FEV", Sum(DECODE(reb_nrmes, 3, reb_vlreceitaarrecadada, 0)) as "MAR", Sum(DECODE(reb_nrmes, 4, reb_vlreceitaarrecadada, 0)) as "ABR", Sum(DECODE(reb_nrmes, 5, reb_vlreceitaarrecadada, 0)) as "MAI", Sum(DECODE(reb_nrmes, 6, reb_vlreceitaarrecadada, 0)) as "JUN", Sum(DECODE(reb_nrmes, 7, reb_vlreceitaarrecadada, 0)) as "JUL", Sum(DECODE(reb_nrmes, 8, reb_vlreceitaarrecadada, 0)) as "AGO", Sum(DECODE(reb_nrmes, 9, reb_vlreceitaarrecadada, 0)) as "SET", Sum(DECODE(reb_nrmes, 10, reb_vlreceitaarrecadada, 0)) as "OUT", Sum(DECODE(reb_nrmes, 11, reb_vlreceitaarrecadada, 0)) as "NOV", Sum(DECODE(reb_nrmes, 12, reb_vlreceitaarrecadada, 0)) as "DEZ", Sum(reb_vlreceitaarrecadada) as Tot_arrec, Sum(reb_vlreceitaOrcada) as Tot_Orcado, round(Sum(reb_vlreceitaarrecadada) / decode(Sum(reb_vlreceitaOrcada), 0, 1, Sum(reb_vlreceitaOrcada)) * 100, 2) as Perc_Arrec_Orca from (Select DECODE(substr(rb.nre_cdnatureza, 1, 2), '11', '11', '12', '12', '13', '13', '14', '14', '15', '15', '16', '16', '17', '17', '19', '19') as Cod, DECODE(substr(rb.nre_cdnatureza, 1, 2), '11', '      Receita Tributária', '12', '      Receitas de Contribuições', '13', '      Receita Patrimonial', '14', '      Receita Agropecuária', '15', '      Receita Industrial', '16', '      Receita de Serviços', '17', '      Transferências Correntes', '19', '      Outras Receitas Correntes') as Origem, rb.reb_nrmes, rb.reb_vlreceitaarrecadada, rb.reb_vlreceitaorcada From ods.tb_reb_receita_bruta rb where rb.reb_nrano = :ano and substr(rb.nre_cdnatureza, 1, 1) = '1') Group by Cod, origem UNION Select '03' as GRID, nvl(Cod,0) as Cod, nvl(ORIGEM,'      NÃO INFORMADO') as Origem, Sum(DECODE(reb_nrmes, 1, reb_vlreceitaarrecadada, 0)) as "JAN", Sum(DECODE(reb_nrmes, 2, reb_vlreceitaarrecadada, 0)) as "FEV", Sum(DECODE(reb_nrmes, 3, reb_vlreceitaarrecadada, 0)) as "MAR", Sum(DECODE(reb_nrmes, 4, reb_vlreceitaarrecadada, 0)) as "ABR", Sum(DECODE(reb_nrmes, 5, reb_vlreceitaarrecadada, 0)) as "MAI", Sum(DECODE(reb_nrmes, 6, reb_vlreceitaarrecadada, 0)) as "JUN", Sum(DECODE(reb_nrmes, 7, reb_vlreceitaarrecadada, 0)) as "JUL", Sum(DECODE(reb_nrmes, 8, reb_vlreceitaarrecadada, 0)) as "AGO", Sum(DECODE(reb_nrmes, 9, reb_vlreceitaarrecadada, 0)) as "SET", Sum(DECODE(reb_nrmes, 10, reb_vlreceitaarrecadada, 0)) as "OUT", Sum(DECODE(reb_nrmes, 11, reb_vlreceitaarrecadada, 0)) as "NOV", Sum(DECODE(reb_nrmes, 12, reb_vlreceitaarrecadada, 0)) as "DEZ", Sum(reb_vlreceitaarrecadada) as Tot_arrec, Sum(reb_vlreceitaOrcada) as Tot_Orcado, round(Sum(reb_vlreceitaarrecadada) / decode(Sum(reb_vlreceitaOrcada), 0, 1, Sum(reb_vlreceitaOrcada)) * 100, 2) as Perc_Arrec_Orca from (Select '02' as Cod, '2 - RECEITAS DE CAPITAL' as Origem, rb.reb_nrmes, rb.reb_vlreceitaarrecadada, rb.reb_vlreceitaorcada From ods.tb_reb_receita_bruta rb where rb.reb_nrano = :ano and substr(rb.nre_cdnatureza, 1, 1) = '2') Group by Cod, origem UNION Select '04' as GRID, nvl(Cod,0) as Cod, nvl(ORIGEM,'      NÃO INFORMADO') as Origem, Sum(DECODE(reb_nrmes, 1, reb_vlreceitaarrecadada, 0)) as "JAN", Sum(DECODE(reb_nrmes, 2, reb_vlreceitaarrecadada, 0)) as "FEV", Sum(DECODE(reb_nrmes, 3, reb_vlreceitaarrecadada, 0)) as "MAR", Sum(DECODE(reb_nrmes, 4, reb_vlreceitaarrecadada, 0)) as "ABR", Sum(DECODE(reb_nrmes, 5, reb_vlreceitaarrecadada, 0)) as "MAI", Sum(DECODE(reb_nrmes, 6, reb_vlreceitaarrecadada, 0)) as "JUN", Sum(DECODE(reb_nrmes, 7, reb_vlreceitaarrecadada, 0)) as "JUL", Sum(DECODE(reb_nrmes, 8, reb_vlreceitaarrecadada, 0)) as "AGO", Sum(DECODE(reb_nrmes, 9, reb_vlreceitaarrecadada, 0)) as "SET", Sum(DECODE(reb_nrmes, 10, reb_vlreceitaarrecadada, 0)) as "OUT", Sum(DECODE(reb_nrmes, 11, reb_vlreceitaarrecadada, 0)) as "NOV", Sum(DECODE(reb_nrmes, 12, reb_vlreceitaarrecadada, 0)) as "DEZ", Sum(reb_vlreceitaarrecadada) as Tot_arrec, Sum(reb_vlreceitaOrcada) as Tot_Orcado, round(Sum(reb_vlreceitaarrecadada) / decode(Sum(reb_vlreceitaOrcada), 0, 1, Sum(reb_vlreceitaOrcada)) * 100, 2) as Perc_Arrec_Orca from (Select DECODE(substr(rb.nre_cdnatureza, 1, 2), '21', '21', '22', '22', '24', '24', '25', '25') as Cod, DECODE(substr(rb.nre_cdnatureza, 1, 2), '21', '      Operações de Crédito', '22', '      Alienação de Bens', '24', '      Transferências de Capital', '25', '      Outras Receitas de Capital') as Origem, rb.reb_nrmes, rb.reb_vlreceitaarrecadada, rb.reb_vlreceitaorcada From ods.tb_reb_receita_bruta rb where rb.reb_nrano = :ano and substr(rb.nre_cdnatureza, 1, 1) = '2') Group by Cod, origem UNION Select '05' as GRID, nvl(Cod,0) as Cod, nvl(ORIGEM,'      NÃO INFORMADO') as Origem, Sum(DECODE(reb_nrmes, 1, reb_vlreceitaarrecadada, 0)) as "JAN", Sum(DECODE(reb_nrmes, 2, reb_vlreceitaarrecadada, 0)) as "FEV", Sum(DECODE(reb_nrmes, 3, reb_vlreceitaarrecadada, 0)) as "MAR", Sum(DECODE(reb_nrmes, 4, reb_vlreceitaarrecadada, 0)) as "ABR", Sum(DECODE(reb_nrmes, 5, reb_vlreceitaarrecadada, 0)) as "MAI", Sum(DECODE(reb_nrmes, 6, reb_vlreceitaarrecadada, 0)) as "JUN", Sum(DECODE(reb_nrmes, 7, reb_vlreceitaarrecadada, 0)) as "JUL", Sum(DECODE(reb_nrmes, 8, reb_vlreceitaarrecadada, 0)) as "AGO", Sum(DECODE(reb_nrmes, 9, reb_vlreceitaarrecadada, 0)) as "SET", Sum(DECODE(reb_nrmes, 10, reb_vlreceitaarrecadada, 0)) as "OUT", Sum(DECODE(reb_nrmes, 11, reb_vlreceitaarrecadada, 0)) as "NOV", Sum(DECODE(reb_nrmes, 12, reb_vlreceitaarrecadada, 0)) as "DEZ", Sum(reb_vlreceitaarrecadada) as Tot_arrec, Sum(reb_vlreceitaOrcada) as Tot_Orcado, round(Sum(reb_vlreceitaarrecadada) / decode(Sum(reb_vlreceitaOrcada), 0, 1, Sum(reb_vlreceitaOrcada)) * 100, 2) as Perc_Arrec_Orca from (Select '07' as Cod, '7 - RECEITAS CORRENTES - OPER. INTRA.' as Origem, rb.reb_nrmes, rb.reb_vlreceitaarrecadada, rb.reb_vlreceitaorcada From ods.tb_reb_receita_bruta rb where rb.reb_nrano = :ano and substr(rb.nre_cdnatureza, 1, 1) = '7') Group by Cod, origem UNION Select '06' as GRID, nvl(Cod,0) as Cod, nvl(ORIGEM,'      NÃO INFORMADO') as Origem, Sum(DECODE(reb_nrmes, 1, reb_vlreceitaarrecadada, 0)) as "JAN", Sum(DECODE(reb_nrmes, 2, reb_vlreceitaarrecadada, 0)) as "FEV", Sum(DECODE(reb_nrmes, 3, reb_vlreceitaarrecadada, 0)) as "MAR", Sum(DECODE(reb_nrmes, 4, reb_vlreceitaarrecadada, 0)) as "ABR", Sum(DECODE(reb_nrmes, 5, reb_vlreceitaarrecadada, 0)) as "MAI", Sum(DECODE(reb_nrmes, 6, reb_vlreceitaarrecadada, 0)) as "JUN", Sum(DECODE(reb_nrmes, 7, reb_vlreceitaarrecadada, 0)) as "JUL", Sum(DECODE(reb_nrmes, 8, reb_vlreceitaarrecadada, 0)) as "AGO", Sum(DECODE(reb_nrmes, 9, reb_vlreceitaarrecadada, 0)) as "SET", Sum(DECODE(reb_nrmes, 10, reb_vlreceitaarrecadada, 0)) as "OUT", Sum(DECODE(reb_nrmes, 11, reb_vlreceitaarrecadada, 0)) as "NOV", Sum(DECODE(reb_nrmes, 12, reb_vlreceitaarrecadada, 0)) as "DEZ", Sum(reb_vlreceitaarrecadada) as Tot_arrec, Sum(reb_vlreceitaOrcada) as Tot_Orcado, round(Sum(reb_vlreceitaarrecadada) / decode(Sum(reb_vlreceitaOrcada), 0, 1, Sum(reb_vlreceitaOrcada)) * 100, 2) as Perc_Arrec_Orca from (Select DECODE(substr(rb.nre_cdnatureza, 1, 2), '72', '72', '73', '73', '76', '76', '79', '79') as Cod, DECODE(substr(rb.nre_cdnatureza, 1, 2), '72', '      Operações de Crédito', '73', '      Alienação de Bens', '76', '      Transferências de Capital', '79', '      Outras Receitas de Capital') as Origem, rb.reb_nrmes, rb.reb_vlreceitaarrecadada, rb.reb_vlreceitaorcada From ods.tb_reb_receita_bruta rb where rb.reb_nrano = :ano and substr(rb.nre_cdnatureza, 1, 1) = '7') Group by Cod, origem UNION Select '07' as GRID, nvl(Cod,0) as Cod, nvl(ORIGEM,'      NÃO INFORMADO') as Origem, ABS(Sum(DECODE(reb_nrmes, 1, reb_vlreceitaarrecadada, 0))) as "JAN", ABS(Sum(DECODE(reb_nrmes, 2, reb_vlreceitaarrecadada, 0))) as "FEV", ABS(Sum(DECODE(reb_nrmes, 3, reb_vlreceitaarrecadada, 0))) as "MAR", ABS(Sum(DECODE(reb_nrmes, 4, reb_vlreceitaarrecadada, 0))) as "ABR", ABS(Sum(DECODE(reb_nrmes, 5, reb_vlreceitaarrecadada, 0))) as "MAI", ABS(Sum(DECODE(reb_nrmes, 6, reb_vlreceitaarrecadada, 0))) as "JUN", ABS(Sum(DECODE(reb_nrmes, 7, reb_vlreceitaarrecadada, 0))) as "JUL", ABS(Sum(DECODE(reb_nrmes, 8, reb_vlreceitaarrecadada, 0))) as "AGO", ABS(Sum(DECODE(reb_nrmes, 9, reb_vlreceitaarrecadada, 0))) as "SET", ABS(Sum(DECODE(reb_nrmes, 10, reb_vlreceitaarrecadada, 0))) as "OUT", ABS(Sum(DECODE(reb_nrmes, 11, reb_vlreceitaarrecadada, 0))) as "NOV", ABS(Sum(DECODE(reb_nrmes, 12, reb_vlreceitaarrecadada, 0))) as "DEZ", ABS(Sum(reb_vlreceitaarrecadada)) as Tot_arrec, ABS(Sum(reb_vlreceitaOrcada)) as Tot_Orcado, round(ABS(Sum(reb_vlreceitaarrecadada) / decode(Sum(reb_vlreceitaOrcada), 0, 1, Sum(reb_vlreceitaOrcada)) * 100), 2) as Perc_Arrec_Orca from (Select '09' as Cod, '9 - DEDUÇÕES DE RECEITA CORRENTE' as Origem, reb_nrmes, rb.reb_vlreceitaarrecadada, rb.reb_vlreceitaorcada From ods.tb_reb_receita_bruta rb where rb.reb_nrano = :ano and substr(rb.nre_cdnatureza, 1, 1) = '9') Group by Cod, origem UNION Select '08' as GRID, nvl(Cod,0) as Cod, nvl(ORIGEM,'      NÃO INFORMADO') as Origem, ABS(Sum(DECODE(reb_nrmes, 1, reb_vlreceitaarrecadada, 0))) as "JAN", ABS(Sum(DECODE(reb_nrmes, 2, reb_vlreceitaarrecadada, 0))) as "FEV", ABS(Sum(DECODE(reb_nrmes, 3, reb_vlreceitaarrecadada, 0))) as "MAR", ABS(Sum(DECODE(reb_nrmes, 4, reb_vlreceitaarrecadada, 0))) as "ABR", ABS(Sum(DECODE(reb_nrmes, 5, reb_vlreceitaarrecadada, 0))) as "MAI", ABS(Sum(DECODE(reb_nrmes, 6, reb_vlreceitaarrecadada, 0))) as "JUN", ABS(Sum(DECODE(reb_nrmes, 7, reb_vlreceitaarrecadada, 0))) as "JUL", ABS(Sum(DECODE(reb_nrmes, 8, reb_vlreceitaarrecadada, 0))) as "AGO", ABS(Sum(DECODE(reb_nrmes, 9, reb_vlreceitaarrecadada, 0))) as "SET", ABS(Sum(DECODE(reb_nrmes, 10, reb_vlreceitaarrecadada, 0))) as "OUT", ABS(Sum(DECODE(reb_nrmes, 11, reb_vlreceitaarrecadada, 0))) as "NOV", ABS(Sum(DECODE(reb_nrmes, 12, reb_vlreceitaarrecadada, 0))) as "DEZ", ABS(Sum(reb_vlreceitaarrecadada)) as Tot_arrec, ABS(Sum(reb_vlreceitaOrcada)) as Tot_Orcado, round(ABS(Sum(reb_vlreceitaarrecadada) / decode(Sum(reb_vlreceitaOrcada), 0, 1, Sum(reb_vlreceitaOrcada)) * 100), 2) as Perc_Arrec_Orca from (Select DECODE(substr(rb.nre_cdnatureza, 1, 2), '91', '91', '93', '93', '97', '97', '99', '99') as Cod, DECODE(substr(rb.nre_cdnatureza, 1, 2), '91', '      Dedução sobre a Receita Tributária', '93', '      Dedução da Receita Patrimonial', '97', '      Dedução sobre Transferências Correntes', '99', '      Outras Receitas Correntes') as Origem, reb_nrmes, rb.reb_vlreceitaarrecadada, rb.reb_vlreceitaorcada From ods.tb_reb_receita_bruta rb where rb.reb_nrano = :ano and substr(rb.nre_cdnatureza, 1, 1) = '9') Group by Cod, origem UNION Select '09' as GRID, nvl(Cod,0) as Cod, nvl(ORIGEM,'      NÃO INFORMADO') as Origem, Sum(DECODE(reb_nrmes, 1, reb_vlreceitaarrecadada, 0)) as "JAN", Sum(DECODE(reb_nrmes, 2, reb_vlreceitaarrecadada, 0)) as "FEV", Sum(DECODE(reb_nrmes, 3, reb_vlreceitaarrecadada, 0)) as "MAR", Sum(DECODE(reb_nrmes, 4, reb_vlreceitaarrecadada, 0)) as "ABR", Sum(DECODE(reb_nrmes, 5, reb_vlreceitaarrecadada, 0)) as "MAI", Sum(DECODE(reb_nrmes, 6, reb_vlreceitaarrecadada, 0)) as "JUN", Sum(DECODE(reb_nrmes, 7, reb_vlreceitaarrecadada, 0)) as "JUL", Sum(DECODE(reb_nrmes, 8, reb_vlreceitaarrecadada, 0)) as "AGO", Sum(DECODE(reb_nrmes, 9, reb_vlreceitaarrecadada, 0)) as "SET", Sum(DECODE(reb_nrmes, 10, reb_vlreceitaarrecadada, 0)) as "OUT", Sum(DECODE(reb_nrmes, 11, reb_vlreceitaarrecadada, 0)) as "NOV", Sum(DECODE(reb_nrmes, 12, reb_vlreceitaarrecadada, 0)) as "DEZ", Sum(reb_vlreceitaarrecadada) as Tot_arrec, Sum(reb_vlreceitaOrcada) as Tot_Orcado, round(Sum(reb_vlreceitaarrecadada) / decode(Sum(reb_vlreceitaOrcada), 0, 1, Sum(reb_vlreceitaOrcada)) * 100, 2) as Perc_Arrec_Orca from (Select '-1' as Cod, 'A - TOTAL RECEITA BRUTA (1+2+7)' as Origem, reb_nrmes, rb.reb_vlreceitaarrecadada, rb.reb_vlreceitaorcada From ods.tb_reb_receita_bruta rb where rb.reb_nrano = :ano and substr(rb.nre_cdnatureza, 1, 1) in ('1', '2', '7')) Group by Cod, origem UNION Select '10' as GRID, nvl(Cod,0) as Cod, nvl(ORIGEM,'      NÃO INFORMADO') as Origem, Sum(DECODE(reb_nrmes, 1, reb_vlreceitaarrecadada, 0)) as "JAN", Sum(DECODE(reb_nrmes, 2, reb_vlreceitaarrecadada, 0)) as "FEV", Sum(DECODE(reb_nrmes, 3, reb_vlreceitaarrecadada, 0)) as "MAR", Sum(DECODE(reb_nrmes, 4, reb_vlreceitaarrecadada, 0)) as "ABR", Sum(DECODE(reb_nrmes, 5, reb_vlreceitaarrecadada, 0)) as "MAI", Sum(DECODE(reb_nrmes, 6, reb_vlreceitaarrecadada, 0)) as "JUN", Sum(DECODE(reb_nrmes, 7, reb_vlreceitaarrecadada, 0)) as "JUL", Sum(DECODE(reb_nrmes, 8, reb_vlreceitaarrecadada, 0)) as "AGO", Sum(DECODE(reb_nrmes, 9, reb_vlreceitaarrecadada, 0)) as "SET", Sum(DECODE(reb_nrmes, 10, reb_vlreceitaarrecadada, 0)) as "OUT", Sum(DECODE(reb_nrmes, 11, reb_vlreceitaarrecadada, 0)) as "NOV", Sum(DECODE(reb_nrmes, 12, reb_vlreceitaarrecadada, 0)) as "DEZ", Sum(reb_vlreceitaarrecadada) as Tot_arrec, Sum(reb_vlreceitaOrcada) as Tot_Orcado, round(Sum(reb_vlreceitaarrecadada) / decode(Sum(reb_vlreceitaOrcada), 0, 1, Sum(reb_vlreceitaOrcada)) * 100, 2) as Perc_Arrec_Orca from (Select '-2' as Cod, 'B - TOTAL DAS OPER. INTRA (7)' as Origem, rb.reb_nrmes, rb.reb_vlreceitaarrecadada, rb.reb_vlreceitaorcada From ods.tb_reb_receita_bruta rb where rb.reb_nrano = :ano and substr(rb.nre_cdnatureza, 1, 1) = '7') Group by Cod, origem UNION Select '11' as GRID, nvl(Cod,0) as Cod, nvl(ORIGEM,'      NÃO INFORMADO') as Origem, ABS(Sum(DECODE(reb_nrmes, 1, reb_vlreceitaarrecadada, 0))) as "JAN", ABS(Sum(DECODE(reb_nrmes, 2, reb_vlreceitaarrecadada, 0))) as "FEV", ABS(Sum(DECODE(reb_nrmes, 3, reb_vlreceitaarrecadada, 0))) as "MAR", ABS(Sum(DECODE(reb_nrmes, 4, reb_vlreceitaarrecadada, 0))) as "ABR", ABS(Sum(DECODE(reb_nrmes, 5, reb_vlreceitaarrecadada, 0))) as "MAI", ABS(Sum(DECODE(reb_nrmes, 6, reb_vlreceitaarrecadada, 0))) as "JUN", ABS(Sum(DECODE(reb_nrmes, 7, reb_vlreceitaarrecadada, 0))) as "JUL", ABS(Sum(DECODE(reb_nrmes, 8, reb_vlreceitaarrecadada, 0))) as "AGO", ABS(Sum(DECODE(reb_nrmes, 9, reb_vlreceitaarrecadada, 0))) as "SET", ABS(Sum(DECODE(reb_nrmes, 10, reb_vlreceitaarrecadada, 0))) as "OUT", ABS(Sum(DECODE(reb_nrmes, 11, reb_vlreceitaarrecadada, 0))) as "NOV", ABS(Sum(DECODE(reb_nrmes, 12, reb_vlreceitaarrecadada, 0))) as "DEZ", ABS(Sum(reb_vlreceitaarrecadada)) as Tot_arrec, ABS(Sum(reb_vlreceitaOrcada)) as Tot_Orcado, round(ABS(Sum(reb_vlreceitaarrecadada) / decode(Sum(reb_vlreceitaOrcada), 0, 1, Sum(reb_vlreceitaOrcada)) * 100), 2) as Perc_Arrec_Orca from (Select '-3' as Cod, 'C - TOTAL DAS DEDUÇÕES (9)' as Origem, rb.reb_nrmes, rb.reb_vlreceitaarrecadada, rb.reb_vlreceitaorcada From ods.tb_reb_receita_bruta rb where rb.reb_nrano = :ano and substr(rb.nre_cdnatureza, 1, 1) = '9') Group by Cod, origem UNION Select '12' as GRID, nvl(Cod,0) as Cod, nvl(ORIGEM,'      NÃO INFORMADO') as Origem, Sum(DECODE(reb_nrmes, 01, reb_vlreceita1 + reb_vlreceita2 - ABS(reb_vlreceita9), 0)) as "JAN", Sum(DECODE(reb_nrmes, 02, reb_vlreceita1 + reb_vlreceita2 - ABS(reb_vlreceita9), 0)) as "FEV", Sum(DECODE(reb_nrmes, 03, reb_vlreceita1 + reb_vlreceita2 - ABS(reb_vlreceita9), 0)) as "MAR", Sum(DECODE(reb_nrmes, 04, reb_vlreceita1 + reb_vlreceita2 - ABS(reb_vlreceita9), 0)) as "ABR", Sum(DECODE(reb_nrmes, 05, reb_vlreceita1 + reb_vlreceita2 - ABS(reb_vlreceita9), 0)) as "MAI", Sum(DECODE(reb_nrmes, 06, reb_vlreceita1 + reb_vlreceita2 - ABS(reb_vlreceita9), 0)) as "JUN", Sum(DECODE(reb_nrmes, 07, reb_vlreceita1 + reb_vlreceita2 - ABS(reb_vlreceita9), 0)) as "JUL", Sum(DECODE(reb_nrmes, 08, reb_vlreceita1 + reb_vlreceita2 - ABS(reb_vlreceita9), 0)) as "AGO", Sum(DECODE(reb_nrmes, 09, reb_vlreceita1 + reb_vlreceita2 - ABS(reb_vlreceita9), 0)) as "SET", Sum(DECODE(reb_nrmes, 10, reb_vlreceita1 + reb_vlreceita2 - ABS(reb_vlreceita9), 0)) as "OUT", Sum(DECODE(reb_nrmes, 11, reb_vlreceita1 + reb_vlreceita2 - ABS(reb_vlreceita9), 0)) as "NOV", Sum(DECODE(reb_nrmes, 12, reb_vlreceita1 + reb_vlreceita2 - ABS(reb_vlreceita9), 0)) as "DEZ", (Sum(reb_vlTotalArrec1) - ABS(Sum(reb_vlTotalArrec9))) as Tot_arrec, (Sum(reb_vlTotalOrc1) - ABS(Sum(reb_vlTotalOrc9))) as Tot_Orcado, round((Sum(reb_vlTotalArrec1) - ABS(Sum(reb_vlTotalArrec9))) / decode((Sum(reb_vlTotalOrc1) - ABS(Sum(reb_vlTotalOrc9))), 0, 1, (Sum(reb_vlTotalOrc1) - ABS(Sum(reb_vlTotalOrc9)))) * 100, 2) as Perc_Arrec_Orca from (Select '-4' as Cod, 'D - RECITA LIQUIDA (A-B-C)' as Origem, rb.reb_nrmes, (Decode(substr(rb.nre_cdnatureza, 1, 1), 1, rb.reb_vlreceitaarrecadada, 0)) AS reb_vlreceita1, (Decode(substr(rb.nre_cdnatureza, 1, 1), 2, rb.reb_vlreceitaarrecadada, 0)) AS reb_vlreceita2, (Decode(substr(rb.nre_cdnatureza, 1, 1), 9, rb.reb_vlreceitaarrecadada, 0)) AS reb_vlreceita9, (Decode(substr(rb.nre_cdnatureza, 1, 1), 1, rb.reb_vlreceitaarrecadada, 2, rb.reb_vlreceitaarrecadada, 0)) as reb_vlTotalArrec1, (Decode(substr(rb.nre_cdnatureza, 1, 1), 9, rb.reb_vlreceitaarrecadada, 0)) as reb_vlTotalArrec9, (Decode(substr(rb.nre_cdnatureza, 1, 1), 1, rb.reb_vlreceitaorcada, 2, rb.reb_vlreceitaorcada, 0)) as reb_vlTotalOrc1, (Decode(substr(rb.nre_cdnatureza, 1, 1), 9, rb.reb_vlreceitaorcada, 0)) as reb_vlTotalOrc9 From ods.tb_reb_receita_bruta rb where rb.reb_nrano = :ano and substr(rb.nre_cdnatureza, 1, 1) IN ('1', '2', '9')) Group by Cod, origem Order by 1, 2   
#public String buscarDiaria()
buscarDiaria = with DIARIA as ( SELECT CNPJ, ORGAO, sum(VL_MES) as VL_MES, sum(VL_ATEMES) as VL_ATEMES FROM (SELECT ORI.ORI_NRCNPJ AS CNPJ, ORI.ORI_DSORGAO AS ORGAO, NVL((SELECT /*+ INDEX (PIG PK_PIG_PAGAMENTO_IGESP) */ SUM(PIG.PIG_VLPAGO) FROM ODS.TB_PIG_PAGAMENTO_IGESP        PIG, ODS.TB_UGI_UNIDADE_GOV_IGESP      UGI, ODS.TB_EDI_ELEMENTO_DESPESA_IGESP EDI WHERE PIG.PIG_NRANO = :ano AND PIG.PIG_NRMES = :mes AND PIG.PIG_CDSITUACAOOB = 4 AND PIG.PIG_CDUG = UGI.UGI_CDUNIDADE AND UGI.ORI_CDORGAO IN (SELECT ORG.ORI_CDORGAO FROM ODS.TB_ORI_ORGAO_IGESP ORG WHERE (ORG.ORI_CDORGAO = ORI.ORI_CDORGAO OR ORG.ORI_CDORGAOSUPERVISOR = ORI.ORI_CDORGAO) AND ORG.ORI_CDNATUREZAORGAO IN (1, 4, 6) AND ORG.ORI_NRCNPJ NOT IN ('13168687000110', '03258406712582') ) AND PIG.PIG_CDELEMENTODESP = EDI.EDI_CDELEMENTODESPESA AND EDI.EDI_CDELEMENTODESPESA IN (14,15) ), 0) AS VL_MES, NVL((SELECT /*+ INDEX (PIG PK_PIG_PAGAMENTO_IGESP) */ SUM(PIG.PIG_VLPAGO) FROM ODS.TB_PIG_PAGAMENTO_IGESP        PIG, ODS.TB_UGI_UNIDADE_GOV_IGESP      UGI, ODS.TB_EDI_ELEMENTO_DESPESA_IGESP EDI WHERE PIG.PIG_NRANO = :ano AND PIG.PIG_NRMES BETWEEN 1 AND :mes AND PIG.PIG_CDSITUACAOOB = 4 AND PIG.PIG_CDUG = UGI.UGI_CDUNIDADE AND UGI.ORI_CDORGAO IN (SELECT ORG.ORI_CDORGAO FROM ODS.TB_ORI_ORGAO_IGESP ORG WHERE (ORG.ORI_CDORGAO = ORI.ORI_CDORGAO OR ORG.ORI_CDORGAOSUPERVISOR = ORI.ORI_CDORGAO) AND ORG.ORI_CDNATUREZAORGAO IN (1, 4, 6) AND ORG.ORI_NRCNPJ NOT IN ('13168687000110', '03258406712582') ) AND PIG.PIG_CDELEMENTODESP = EDI.EDI_CDELEMENTODESPESA AND EDI.EDI_CDELEMENTODESPESA IN (14,15) ), 0) AS VL_ATEMES FROM ODS.TB_ORI_ORGAO_IGESP ORI WHERE ORI.PDE_CDPODER = 3 AND ORI.ORI_CDNATUREZAORGAO IN (1, 4)  UNION  SELECT ORI.ORI_NRCNPJ AS CNPJ, ORI.ORI_DSORGAO AS ORGAO, NVL((SELECT /*+ INDEX (PIG PK_PIG_PAGAMENTO_IGESP) */ SUM(PIG.PIG_VLPAGO) FROM ODS.TB_PIG_PAGAMENTO_IGESP        PIG, ODS.TB_UGI_UNIDADE_GOV_IGESP      UGI, ODS.TB_EDI_ELEMENTO_DESPESA_IGESP EDI WHERE PIG.PIG_NRANO = :ano AND PIG.PIG_NRMES = :mes AND PIG.PIG_CDSITUACAOOB = 4 AND PIG.PIG_CDUG = UGI.UGI_CDUNIDADE AND UGI.ORI_CDORGAO IN (SELECT ORG.ORI_CDORGAO FROM ODS.TB_ORI_ORGAO_IGESP ORG WHERE (ORG.ORI_CDORGAO = ORI.ORI_CDORGAO OR ORG.ORI_CDORGAOSUPERVISOR = ORI.ORI_CDORGAO) AND ORG.ORI_CDNATUREZAORGAO IN (2, 3, 5) AND  ORG.ORI_NRCNPJ NOT IN ('13168687000110', '86809043000138') ) AND PIG.PIG_CDELEMENTODESP = EDI.EDI_CDELEMENTODESPESA AND EDI.EDI_CDELEMENTODESPESA IN (14,15) ), 0) AS VL_MES, NVL((SELECT /*+ INDEX (PIG PK_PIG_PAGAMENTO_IGESP) */ SUM(PIG.PIG_VLPAGO) FROM ODS.TB_PIG_PAGAMENTO_IGESP        PIG, ODS.TB_UGI_UNIDADE_GOV_IGESP      UGI, ODS.TB_EDI_ELEMENTO_DESPESA_IGESP EDI WHERE PIG.PIG_NRANO = :ano AND PIG.PIG_NRMES BETWEEN 1 AND :mes AND PIG.PIG_CDSITUACAOOB = 4 AND PIG.PIG_CDUG = UGI.UGI_CDUNIDADE AND UGI.ORI_CDORGAO IN (SELECT ORG.ORI_CDORGAO FROM ODS.TB_ORI_ORGAO_IGESP ORG WHERE (ORG.ORI_CDORGAO = ORI.ORI_CDORGAO OR ORG.ORI_CDORGAOSUPERVISOR = ORI.ORI_CDORGAO) AND ORG.ORI_CDNATUREZAORGAO IN (2, 3, 5) AND  ORG.ORI_NRCNPJ NOT IN ('13168687000110', '86809043000138') ) AND PIG.PIG_CDELEMENTODESP = EDI.EDI_CDELEMENTODESPESA AND EDI.EDI_CDELEMENTODESPESA IN (14,15) ), 0) AS VL_ATEMES FROM ODS.TB_ORI_ORGAO_IGESP ORI WHERE ORI.PDE_CDPODER = 3 AND ORI.ORI_CDNATUREZAORGAO IN (1, 4)) WHERE VL_ATEMES > 0 GROUP BY CNPJ, ORGAO) SELECT * FROM DIARIA UNION SELECT '99999999999999' AS CNPJ, 'TOTAL' AS ORGAO, SUM(VL_MES) AS VL_MES, SUM(VL_ATEMES) AS VL_ATEMES FROM DIARIA ORDER BY 2 
#public String buscarDiariaAvancado(String codigo, String orgao)
buscarDiariaAvancado = with DIARIA as ( SELECT CNPJ, ORGAO, sum(VL_MES) as VL_MES, sum(VL_ATEMES) as VL_ATEMES FROM (SELECT ORI.ORI_NRCNPJ AS CNPJ, ORI.ORI_DSORGAO AS ORGAO, NVL((SELECT /*+ INDEX (PIG PK_PIG_PAGAMENTO_IGESP) */ SUM(PIG.PIG_VLPAGO) FROM ODS.TB_PIG_PAGAMENTO_IGESP        PIG, ODS.TB_UGI_UNIDADE_GOV_IGESP      UGI, ODS.TB_EDI_ELEMENTO_DESPESA_IGESP EDI WHERE PIG.PIG_NRANO = :ano AND PIG.PIG_NRMES = :mes AND PIG.PIG_CDSITUACAOOB = 4 AND PIG.PIG_CDUG = UGI.UGI_CDUNIDADE AND UGI.ORI_CDORGAO IN (SELECT ORG.ORI_CDORGAO FROM ODS.TB_ORI_ORGAO_IGESP ORG WHERE (ORG.ORI_CDORGAO = ORI.ORI_CDORGAO OR ORG.ORI_CDORGAOSUPERVISOR = ORI.ORI_CDORGAO) AND ORG.ORI_CDNATUREZAORGAO IN (1, 4, 6) AND ORG.ORI_NRCNPJ NOT IN ('13168687000110', '03258406712582') ) AND PIG.PIG_CDELEMENTODESP = EDI.EDI_CDELEMENTODESPESA AND EDI.EDI_CDELEMENTODESPESA IN (14,15) ), 0) AS VL_MES, NVL((SELECT /*+ INDEX (PIG PK_PIG_PAGAMENTO_IGESP) */ SUM(PIG.PIG_VLPAGO) FROM ODS.TB_PIG_PAGAMENTO_IGESP        PIG, ODS.TB_UGI_UNIDADE_GOV_IGESP      UGI, ODS.TB_EDI_ELEMENTO_DESPESA_IGESP EDI WHERE PIG.PIG_NRANO = :ano AND PIG.PIG_NRMES BETWEEN 1 AND :mes AND PIG.PIG_CDSITUACAOOB = 4 AND PIG.PIG_CDUG = UGI.UGI_CDUNIDADE AND UGI.ORI_CDORGAO IN (SELECT ORG.ORI_CDORGAO FROM ODS.TB_ORI_ORGAO_IGESP ORG WHERE (ORG.ORI_CDORGAO = ORI.ORI_CDORGAO OR ORG.ORI_CDORGAOSUPERVISOR = ORI.ORI_CDORGAO) AND ORG.ORI_CDNATUREZAORGAO IN (1, 4, 6) AND ORG.ORI_NRCNPJ NOT IN ('13168687000110', '03258406712582') ) AND PIG.PIG_CDELEMENTODESP = EDI.EDI_CDELEMENTODESPESA AND EDI.EDI_CDELEMENTODESPESA IN (14,15) ), 0) AS VL_ATEMES FROM ODS.TB_ORI_ORGAO_IGESP ORI WHERE ORI.PDE_CDPODER = 3 AND ORI.ORI_CDNATUREZAORGAO IN (1, 4)  UNION  SELECT ORI.ORI_NRCNPJ AS CNPJ, ORI.ORI_DSORGAO AS ORGAO, NVL((SELECT /*+ INDEX (PIG PK_PIG_PAGAMENTO_IGESP) */ SUM(PIG.PIG_VLPAGO) FROM ODS.TB_PIG_PAGAMENTO_IGESP        PIG, ODS.TB_UGI_UNIDADE_GOV_IGESP      UGI, ODS.TB_EDI_ELEMENTO_DESPESA_IGESP EDI WHERE PIG.PIG_NRANO = :ano AND PIG.PIG_NRMES = :mes AND PIG.PIG_CDSITUACAOOB = 4 AND PIG.PIG_CDUG = UGI.UGI_CDUNIDADE AND UGI.ORI_CDORGAO IN (SELECT ORG.ORI_CDORGAO FROM ODS.TB_ORI_ORGAO_IGESP ORG WHERE (ORG.ORI_CDORGAO = ORI.ORI_CDORGAO OR ORG.ORI_CDORGAOSUPERVISOR = ORI.ORI_CDORGAO) AND ORG.ORI_CDNATUREZAORGAO IN (2, 3, 5) AND  ORG.ORI_NRCNPJ NOT IN ('13168687000110', '86809043000138') ) AND PIG.PIG_CDELEMENTODESP = EDI.EDI_CDELEMENTODESPESA AND EDI.EDI_CDELEMENTODESPESA IN (14,15) ), 0) AS VL_MES, NVL((SELECT /*+ INDEX (PIG PK_PIG_PAGAMENTO_IGESP) */ SUM(PIG.PIG_VLPAGO) FROM ODS.TB_PIG_PAGAMENTO_IGESP        PIG, ODS.TB_UGI_UNIDADE_GOV_IGESP      UGI, ODS.TB_EDI_ELEMENTO_DESPESA_IGESP EDI WHERE PIG.PIG_NRANO = :ano AND PIG.PIG_NRMES BETWEEN 1 AND :mes AND PIG.PIG_CDSITUACAOOB = 4 AND PIG.PIG_CDUG = UGI.UGI_CDUNIDADE AND UGI.ORI_CDORGAO IN (SELECT ORG.ORI_CDORGAO FROM ODS.TB_ORI_ORGAO_IGESP ORG WHERE (ORG.ORI_CDORGAO = ORI.ORI_CDORGAO OR ORG.ORI_CDORGAOSUPERVISOR = ORI.ORI_CDORGAO) AND ORG.ORI_CDNATUREZAORGAO IN (2, 3, 5) AND  ORG.ORI_NRCNPJ NOT IN ('13168687000110', '86809043000138') ) AND PIG.PIG_CDELEMENTODESP = EDI.EDI_CDELEMENTODESPESA AND EDI.EDI_CDELEMENTODESPESA IN (14,15) ), 0) AS VL_ATEMES FROM ODS.TB_ORI_ORGAO_IGESP ORI WHERE ORI.PDE_CDPODER = 3 AND ORI.ORI_CDNATUREZAORGAO IN (1, 4)) WHERE VL_ATEMES > 0 {0} {1} GROUP BY CNPJ, ORGAO) SELECT * FROM DIARIA UNION SELECT '99999999999999' AS CNPJ, 'TOTAL' AS ORGAO, SUM(VL_MES) AS VL_MES, SUM(VL_ATEMES) AS VL_ATEMES FROM DIARIA ORDER BY 2 
#public String buscarPassagem()
buscarPassagem = with PASSAGEM as (SELECT CNPJ, ORGAO, SUM( VL_MES ) AS VL_MES, SUM( VL_ATEMES ) AS VL_ATEMES FROM ( SELECT ORI.ORI_NRCNPJ AS CNPJ, ORI.ORI_DSORGAO AS ORGAO, NVL( ( SELECT SUM( PIG.PIG_VLPAGO ) FROM ODS.TB_PIG_PAGAMENTO_IGESP PIG, ODS.TB_UGI_UNIDADE_GOV_IGESP UGI, ODS.TB_EDI_ELEMENTO_DESPESA_IGESP EDI WHERE PIG.PIG_NRANO = :ano AND PIG.PIG_NRMES = :mes AND PIG.PIG_CDSITUACAOOB = 4 AND PIG.PIG_CDUG = UGI.UGI_CDUNIDADE AND PIG.PIG_CDELEMENTODESP = EDI.EDI_CDELEMENTODESPESA AND EDI.EDI_CDELEMENTODESPESA = 33 AND UGI.ORI_CDORGAO IN ( SELECT ORG.ORI_CDORGAO FROM ODS.TB_ORI_ORGAO_IGESP ORG WHERE ( ORG.ORI_CDORGAO = ORI.ORI_CDORGAO OR ORG.ORI_CDORGAOSUPERVISOR = ORI.ORI_CDORGAO ) ) ), 0 ) AS VL_MES, NVL( ( SELECT SUM( PIG.PIG_VLPAGO ) FROM ODS.TB_PIG_PAGAMENTO_IGESP PIG, ODS.TB_UGI_UNIDADE_GOV_IGESP UGI, ODS.TB_EDI_ELEMENTO_DESPESA_IGESP EDI WHERE PIG.PIG_NRANO = :ano AND PIG.PIG_NRMES BETWEEN 1 AND :mes AND PIG.PIG_CDSITUACAOOB = 4 AND PIG.PIG_CDUG = UGI.UGI_CDUNIDADE AND PIG.PIG_CDELEMENTODESP = EDI.EDI_CDELEMENTODESPESA AND EDI.EDI_CDELEMENTODESPESA = 33 AND UGI.ORI_CDORGAO IN ( SELECT ORG.ORI_CDORGAO FROM ODS.TB_ORI_ORGAO_IGESP ORG WHERE ( ORG.ORI_CDORGAO = ORI.ORI_CDORGAO OR ORG.ORI_CDORGAOSUPERVISOR = ORI.ORI_CDORGAO ) ) ), 0 ) AS VL_ATEMES FROM ODS.TB_ORI_ORGAO_IGESP ORI WHERE ORI.PDE_CDPODER = 3 AND ORI.ORI_CDNATUREZAORGAO = 1 AND ORI.ORI_NRCNPJ NOT IN ( '13168687000110', '03258406712582' ) AND ORI.ORI_dtFIMVIGENCIA IS null ) WHERE VL_ATEMES > 0 GROUP BY CNPJ,ORGAO ORDER BY ORGAO) SELECT * FROM PASSAGEM UNION SELECT '99999999999999' AS CNPJ, 'TOTAL' AS ORGAO, SUM(VL_MES) AS VL_MES, SUM(VL_ATEMES) AS VL_ATEMES FROM PASSAGEM ORDER BY 2 
#public String buscarPassagemAvancado(String codigo, String orgao)
buscarPassagemAvancado = with PASSAGEM as ( SELECT CNPJ, ORGAO, sum(VL_MES) as VL_MES, sum(VL_ATEMES) as VL_ATEMES FROM (SELECT ORI.ORI_NRCNPJ AS CNPJ, ORI.ORI_DSORGAO AS ORGAO, NVL((SELECT /*+ INDEX (PIG PK_PIG_PAGAMENTO_IGESP) */ SUM(PIG.PIG_VLPAGO) FROM ODS.TB_PIG_PAGAMENTO_IGESP        PIG, ODS.TB_UGI_UNIDADE_GOV_IGESP      UGI, ODS.TB_EDI_ELEMENTO_DESPESA_IGESP EDI WHERE PIG.PIG_NRANO = :ano AND PIG.PIG_NRMES = :mes AND PIG.PIG_CDSITUACAOOB = 4 AND PIG.PIG_CDUG = UGI.UGI_CDUNIDADE AND UGI.ORI_CDORGAO IN (SELECT ORG.ORI_CDORGAO FROM ODS.TB_ORI_ORGAO_IGESP ORG WHERE (ORG.ORI_CDORGAO = ORI.ORI_CDORGAO OR ORG.ORI_CDORGAOSUPERVISOR = ORI.ORI_CDORGAO) AND ORG.ORI_CDNATUREZAORGAO IN (1, 4, 6) AND ORG.ORI_NRCNPJ NOT IN ('13168687000110', '03258406712582') ) AND PIG.PIG_CDELEMENTODESP = EDI.EDI_CDELEMENTODESPESA AND EDI.EDI_CDELEMENTODESPESA = 33 ), 0) AS VL_MES, NVL((SELECT /*+ INDEX (PIG PK_PIG_PAGAMENTO_IGESP) */ SUM(PIG.PIG_VLPAGO) FROM ODS.TB_PIG_PAGAMENTO_IGESP        PIG, ODS.TB_UGI_UNIDADE_GOV_IGESP      UGI, ODS.TB_EDI_ELEMENTO_DESPESA_IGESP EDI WHERE PIG.PIG_NRANO = :ano AND PIG.PIG_NRMES BETWEEN 1 AND :mes AND PIG.PIG_CDSITUACAOOB = 4 AND PIG.PIG_CDUG = UGI.UGI_CDUNIDADE AND UGI.ORI_CDORGAO IN (SELECT ORG.ORI_CDORGAO FROM ODS.TB_ORI_ORGAO_IGESP ORG WHERE (ORG.ORI_CDORGAO = ORI.ORI_CDORGAO OR ORG.ORI_CDORGAOSUPERVISOR = ORI.ORI_CDORGAO) AND ORG.ORI_CDNATUREZAORGAO IN (1, 4, 6) AND ORG.ORI_NRCNPJ NOT IN ('13168687000110', '03258406712582') ) AND PIG.PIG_CDELEMENTODESP = EDI.EDI_CDELEMENTODESPESA AND EDI.EDI_CDELEMENTODESPESA = 33 ), 0) AS VL_ATEMES FROM ODS.TB_ORI_ORGAO_IGESP ORI WHERE ORI.PDE_CDPODER = 3 AND ORI.ORI_CDNATUREZAORGAO IN (1, 4)  UNION  SELECT ORI.ORI_NRCNPJ AS CNPJ, ORI.ORI_DSORGAO AS ORGAO, NVL((SELECT /*+ INDEX (PIG PK_PIG_PAGAMENTO_IGESP) */ SUM(PIG.PIG_VLPAGO) FROM ODS.TB_PIG_PAGAMENTO_IGESP        PIG, ODS.TB_UGI_UNIDADE_GOV_IGESP      UGI, ODS.TB_EDI_ELEMENTO_DESPESA_IGESP EDI WHERE PIG.PIG_NRANO = :ano AND PIG.PIG_NRMES = :mes AND PIG.PIG_CDSITUACAOOB = 4 AND PIG.PIG_CDUG = UGI.UGI_CDUNIDADE AND UGI.ORI_CDORGAO IN (SELECT ORG.ORI_CDORGAO FROM ODS.TB_ORI_ORGAO_IGESP ORG WHERE (ORG.ORI_CDORGAO = ORI.ORI_CDORGAO OR ORG.ORI_CDORGAOSUPERVISOR = ORI.ORI_CDORGAO) AND ORG.ORI_CDNATUREZAORGAO IN (2, 3, 5) AND  ORG.ORI_NRCNPJ NOT IN ('13168687000110', '86809043000138') ) AND PIG.PIG_CDELEMENTODESP = EDI.EDI_CDELEMENTODESPESA AND EDI.EDI_CDELEMENTODESPESA = 33 ), 0) AS VL_MES, NVL((SELECT /*+ INDEX (PIG PK_PIG_PAGAMENTO_IGESP) */ SUM(PIG.PIG_VLPAGO) FROM ODS.TB_PIG_PAGAMENTO_IGESP        PIG, ODS.TB_UGI_UNIDADE_GOV_IGESP      UGI, ODS.TB_EDI_ELEMENTO_DESPESA_IGESP EDI WHERE PIG.PIG_NRANO = :ano AND PIG.PIG_NRMES BETWEEN 1 AND :mes AND PIG.PIG_CDSITUACAOOB = 4 AND PIG.PIG_CDUG = UGI.UGI_CDUNIDADE AND UGI.ORI_CDORGAO IN (SELECT ORG.ORI_CDORGAO FROM ODS.TB_ORI_ORGAO_IGESP ORG WHERE (ORG.ORI_CDORGAO = ORI.ORI_CDORGAO OR ORG.ORI_CDORGAOSUPERVISOR = ORI.ORI_CDORGAO) AND ORG.ORI_CDNATUREZAORGAO IN (2, 3, 5) AND  ORG.ORI_NRCNPJ NOT IN ('13168687000110', '86809043000138') ) AND PIG.PIG_CDELEMENTODESP = EDI.EDI_CDELEMENTODESPESA AND EDI.EDI_CDELEMENTODESPESA = 33 ), 0) AS VL_ATEMES FROM ODS.TB_ORI_ORGAO_IGESP ORI WHERE ORI.PDE_CDPODER = 3 ) WHERE VL_ATEMES > 0 {0} {1} GROUP BY CNPJ, ORGAO) SELECT * FROM PASSAGEM UNION SELECT '99999999999999' AS CNPJ, 'TOTAL' AS ORGAO, SUM(VL_MES) AS VL_MES, SUM(VL_ATEMES) AS VL_ATEMES FROM PASSAGEM ORDER BY 2 
#public String buscarNatureza()
buscarNatureza = SELECT ORI.ORI_CDNATUREZAORGAO FROM ODS.TB_ORI_ORGAO_IGESP ORI WHERE ORI.ORI_NRCNPJ = :orgao 
#public String buscarId()
buscarId = SELECT ORI.ORI_CDORGAO FROM ODS.TB_ORI_ORGAO_IGESP ORI WHERE ORI.ORI_NRCNPJ = :orgao 
#public String buscarMaxValorReceitaMensal()
buscarMaxValorReceitaMensal = SELECT ROUND(MAX(VALOR) + (MAX(VALOR) * 10) / 100, 0) MAXIMO FROM (SELECT REB.REB_NRANO, REB.REB_NRMES, SUM(REB.REB_VLRECEITAARRECADADA) AS VALOR FROM ODS.TB_REB_RECEITA_BRUTA REB WHERE REB.REB_NRANO = :ano GROUP BY REB.REB_NRANO, REB.REB_NRMES  UNION  SELECT REB.REB_NRANO, REB.REB_NRMES, (SELECT ROUND(SUM(REB2.REB_VLRECEITAORCADA) / 12, 2) FROM ODS.TB_REB_RECEITA_BRUTA REB2 WHERE REB2.REB_NRANO = :ano AND REB2.REB_NRMES = 1) + DECODE(REB.REB_NRMES, 1, 0, SUM(REB.REB_VLRECEITAORCADA)) AS VALOR FROM ODS.TB_REB_RECEITA_BRUTA REB WHERE REB.REB_NRANO = :ano GROUP BY REB.REB_NRANO, REB.REB_NRMES) 
#public String buscarMaxValorReceitaAnual()
buscarMaxValorReceitaAnual = SELECT ROUND(MAX(VALOR) + (MAX(VALOR) * 10) / 100, 0) MAXIMO FROM (SELECT REB.REB_NRANO, SUM(REB.REB_VLRECEITAORCADA) AS VALOR FROM ODS.TB_REB_RECEITA_BRUTA REB WHERE REB.REB_NRANO between :ano - 5 and :ano GROUP BY REB.REB_NRANO) 
